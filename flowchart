graph TB
    Start([App Start]) --> CheckUser{Erster<br/>Besuch?}
    
    %% Onboarding Flow
    CheckUser -->|Ja| Welcome[Welcome Screen]
    Welcome --> FacultySelect[Fakult√§ts-Auswahl<br/>16 Fakult√§ten]
    FacultySelect --> FeatureTour[Feature Tour]
    FeatureTour --> Home[Home Dashboard]
    
    CheckUser -->|Nein| Home
    
    %% Main Navigation
    Home --> Nav{Navigation}
    
    Nav --> HomePage[üè† Home]
    Nav --> NewsPage[üì∞ News Feed]
    Nav --> ChallengesPage[üèÜ Challenges]
    Nav --> DashboardPage[üìä Dashboard]
    Nav --> CommunityPage[üë• Community]
    Nav --> RewardsPage[üéÅ Rewards]
    Nav --> ProfilePage[üë§ Profil]
    
    %% Home Page - Quick Actions
    HomePage --> QuickActions[Quick Actions]
    QuickActions --> BikeAction[üö¥ Fahrrad-Tracking]
    QuickActions --> RecycleAction[‚ôªÔ∏è Recycling Scanner]
    QuickActions --> CupAction[ü•§ Mehrwegbecher]
    QuickActions --> BookAction[üìö B√ºchertausch]
    QuickActions --> QuizAction[üß† Quiz]
    
    BikeAction --> BikeModal[GPS aktivieren & tracken]
    BikeModal --> BikeCoins[+10-30 Coins]
    
    RecycleAction --> RecycleModal[Kamera & scannen]
    RecycleModal --> RecycleCoins[+15 Coins]
    
    CupAction --> CupModal[Nutzung best√§tigen]
    CupModal --> CupCoins[+5 Coins]
    
    BookAction --> BookModal[Spenden/Tauschen]
    BookModal --> BookCoins[+50 Coins]
    
    QuizAction --> QuizModal[10 Fragen]
    QuizModal --> QuizCoins[+10-20 Coins]
    
    BikeCoins --> UpdateCoins[Coins & Fortschritt<br/>aktualisieren]
    RecycleCoins --> UpdateCoins
    CupCoins --> UpdateCoins
    BookCoins --> UpdateCoins
    QuizCoins --> UpdateCoins
    
    UpdateCoins --> Animation[üéä Punkte-Animation]
    Animation --> Home
    
    %% Challenges Page
    ChallengesPage --> ChallengeTypes{Challenge Status}
    ChallengeTypes --> ActiveChal[Aktive Challenges]
    ChallengeTypes --> AvailableChal[Verf√ºgbare Challenges]
    ChallengeTypes --> CompletedChal[Abgeschlossene]
    
    AvailableChal --> SelectChallenge[Challenge ausw√§hlen]
    SelectChallenge --> ActivateChallenge[Challenge aktivieren]
    ActivateChallenge --> ActiveChal
    
    ActiveChal --> DoAction[Aktionen durchf√ºhren]
    DoAction --> CheckProgress{Ziel<br/>erreicht?}
    CheckProgress -->|Nein| DoAction
    CheckProgress -->|Ja| ChallengeReward[Belohnung erhalten]
    ChallengeReward --> CompletedChal
    
    %% News Feed Page
    NewsPage --> NewsFilter{Filter}
    NewsFilter --> ShowNews[News]
    NewsFilter --> ShowEvents[Events]
    
    ShowNews --> NewsPost[News Post]
    NewsPost --> Like[üëç Like]
    NewsPost --> Comment[üí¨ Kommentar]
    
    ShowEvents --> EventPost[Event]
    EventPost --> RegisterEvent[Anmelden]
    RegisterEvent --> EventCoins[+30-100 Coins bei Teilnahme]
    
    %% Rewards Page
    RewardsPage --> RewardCategories[Kategorien:<br/>Rabatte, Gutscheine,<br/>Events, Produkte]
    RewardCategories --> SelectReward[Belohnung ausw√§hlen]
    SelectReward --> CheckCoins{Genug<br/>Coins?}
    CheckCoins -->|Nein| RewardsPage
    CheckCoins -->|Ja| RedeemReward[Einl√∂sen]
    RedeemReward --> GenerateCode[Code generieren]
    GenerateCode --> ShowCode[‚úÖ Code anzeigen]
    
    %% Community Page
    CommunityPage --> CommunityTabs{Tab Auswahl}
    CommunityTabs --> Leaderboard[Gesamtrangliste<br/>Top 100 User]
    CommunityTabs --> FacultyRank[Fakult√§ts-Rangliste<br/>16 Fakult√§ten]
    CommunityTabs --> Friends[Freunde]
    
    Friends --> FriendsList[Freundesliste]
    Friends --> AddFriend[Freund hinzuf√ºgen]
    FriendsList --> SendChallenge[Friend Challenge]
    SendChallenge --> Notification[üì± Benachrichtigung]
    
    %% Dashboard Page
    DashboardPage --> DashboardOverview[√úbersicht]
    DashboardOverview --> WeekProgress[W√∂chentlicher Fortschritt]
    DashboardOverview --> CO2Stats[CO‚ÇÇ-Ersparnis]
    DashboardOverview --> ActivityStats[Aktivit√§tsstatistiken]
    DashboardOverview --> Achievements[Achievements & Badges]
    
    Achievements --> Bronze[ü•â Bronze]
    Achievements --> Silver[ü•à Silber]
    Achievements --> Gold[ü•á Gold]
    Achievements --> Platinum[üíé Platin]
    
    %% Profile Page
    ProfilePage --> ProfileInfo[Profilinfo:<br/>Name, Email, Fakult√§t,<br/>Level, Streak, Coins]
    ProfilePage --> Settings[‚öôÔ∏è Einstellungen]
    
    Settings --> SettingsOptions{Einstellungen}
    SettingsOptions --> Language[Sprache: DE/EN]
    SettingsOptions --> Notifications[Benachrichtigungen]
    SettingsOptions --> DarkMode[Dark Mode]
    SettingsOptions --> Privacy[Datenschutz]
    SettingsOptions --> Logout[Abmelden]
    
    DarkMode --> ThemeToggle[‚òÄÔ∏è Light / üåô Dark]
    Logout --> ClearData[Daten l√∂schen]
    ClearData --> Start
    
    %% Data Persistence
    UpdateCoins -.-> LocalStorage[(localStorage)]
    ActivateChallenge -.-> LocalStorage
    RedeemReward -.-> LocalStorage
    AddFriend -.-> LocalStorage
    Settings -.-> LocalStorage
    
    LocalStorage -.-> UserProfile[User-Profil]
    LocalStorage -.-> EcoCoins[Eco Coins]
    LocalStorage -.-> ChallengesData[Challenges]
    LocalStorage -.-> ActivitiesData[Aktivit√§ten]
    LocalStorage -.-> SettingsData[Einstellungen]
    LocalStorage -.-> FriendsData[Freunde]
    LocalStorage -.-> RewardsData[Belohnungen]
    
    %% Styling
    style Start fill:#10b981
    style Home fill:#10b981
    style UpdateCoins fill:#10b981
    style Animation fill:#ec4899
    style ChallengeReward fill:#10b981
    style EventCoins fill:#10b981
    style ShowCode fill:#10b981
    style ChallengesPage fill:#f59e0b
    style RewardsPage fill:#f59e0b
    style CommunityPage fill:#a855f7
    style DashboardPage fill:#8b5cf6
    style ProfilePage fill:#3b82f6
    style LocalStorage fill:#f59e0b
    style Platinum fill:#f59e0b
    style DarkMode fill:#1f2937
